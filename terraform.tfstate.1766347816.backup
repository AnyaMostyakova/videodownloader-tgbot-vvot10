{
  "version": 4,
  "terraform_version": "1.12.2",
  "serial": 23,
  "lineage": "3a9123a2-27cc-05e3-c03f-2bceda3fd110",
  "outputs": {
    "api_gateway_domain": {
      "value": "d5dvao10bjmflojdlm3f.z7jmlavt.apigw.yandexcloud.net",
      "type": "string"
    },
    "bucket_name": {
      "value": "vvot10-tg-video",
      "type": "string"
    },
    "webhook_url": {
      "value": "https://d5dvao10bjmflojdlm3f.z7jmlavt.apigw.yandexcloud.net/webhook",
      "type": "string"
    }
  },
  "resources": [
    {
      "mode": "data",
      "type": "archive_file",
      "name": "downloader_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "03f54c900edbf65ef8747cf73c89e64d7f500044",
            "output_base64sha256": "PXa+xpobjxX+xW86/2UPqtkSNNXQilelUybHPRdY4zM=",
            "output_base64sha512": "qM/LTRjLG1XaoX3dvIe9TamPWKoMDZ3bkltHBYch4xxmB8FMj16N00x8vNFdRKiF82W9FHYtCbxyYJD0qISlRQ==",
            "output_file_mode": null,
            "output_md5": "0081ecdacb777af315acc1605a06adcd",
            "output_path": "./build/downloader.zip",
            "output_sha": "03f54c900edbf65ef8747cf73c89e64d7f500044",
            "output_sha256": "3d76bec69a1b8f15fec56f3aff650faad91234d5d08a57a55326c73d1758e333",
            "output_sha512": "a8cfcb4d18cb1b55daa17dddbc87bd4da98f58aa0c0d9ddb925b47058721e31c6607c14c8f5e8dd34c7cbcd15d44a885f365bd14762d09bc726090f4a884a545",
            "output_size": 2092,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "./functions/downloader",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "data",
      "type": "archive_file",
      "name": "receiver_zip",
      "provider": "provider[\"registry.terraform.io/hashicorp/archive\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "exclude_symlink_directories": null,
            "excludes": null,
            "id": "8774e71eb83bc31d4ac19019517d3424ca4f46fa",
            "output_base64sha256": "NBM9Hf6jpIKVZJ/d3UEXlif7Mmw9PS2KRMr94zQkVC8=",
            "output_base64sha512": "ZZG0lpt37aA/g9kGf2W9xyfocJ6CyQuIc4NoaNTs2XkbzpUYc1R2jb+PSMHAXDiKV5FdPE9wkZr0V9rAtIIwYQ==",
            "output_file_mode": null,
            "output_md5": "e961f7cf7ea757cc165a45b54ec8dd07",
            "output_path": "./build/receiver.zip",
            "output_sha": "8774e71eb83bc31d4ac19019517d3424ca4f46fa",
            "output_sha256": "34133d1dfea3a48295649fdddd41179627fb326c3d3d2d8a44cafde33424542f",
            "output_sha512": "6591b4969b77eda03f83d9067f65bdc727e8709e82c90b8873836868d4ecd9791bce95187354768dbf8f48c1c05c388a57915d3c4f70919af457dac0b4823061",
            "output_size": 1724,
            "source": [],
            "source_content": null,
            "source_content_filename": null,
            "source_dir": "./functions/receiver",
            "source_file": null,
            "type": "zip"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0
        }
      ]
    },
    {
      "mode": "managed",
      "type": "telegram_bot_webhook",
      "name": "webhook",
      "provider": "provider[\"registry.terraform.io/yi-jiayu/telegram\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "allowed_updates": null,
            "id": "webhook",
            "max_connections": 40,
            "url": "https://d5dvao10bjmflojdlm3f.z7jmlavt.apigw.yandexcloud.net/webhook"
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "bnVsbA==",
          "dependencies": [
            "data.archive_file.receiver_zip",
            "data.template_file.openapi_spec",
            "yandex_api_gateway.api",
            "yandex_function.func_receiver",
            "yandex_message_queue.queue_downloader",
            "yandex_message_queue.queue_receiver",
            "yandex_storage_bucket.bucket"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_api_gateway",
      "name": "api",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "canary": [],
            "connectivity": [],
            "created_at": "2025-12-21T17:53:30Z",
            "custom_domains": [],
            "description": "API Gateway for Telegram bot",
            "domain": "d5dvao10bjmflojdlm3f.z7jmlavt.apigw.yandexcloud.net",
            "execution_timeout": "300",
            "folder_id": "b1gkt91feoc05m2bu972",
            "id": "d5dvao10bjmflojdlm3f",
            "labels": {},
            "log_group_id": "",
            "log_options": [],
            "name": "vvot10-api",
            "spec": "openapi: 3.0.0\r\ninfo:\r\n  title: vvot10-api\r\n  version: 1.0.0\r\npaths:\r\n  /webhook:\r\n    post:\r\n      summary: Telegram webhook\r\n      x-yc-apigateway-integration:\r\n        type: cloud_functions\r\n        function_id: d4e3f81idssgfs5papic\r\n        service_account_id: aje8krpkjdmjihbrrdo4\r\n        tag: \"$latest\"\r\n      responses:\r\n        '200':\r\n          description: OK\r\n  /video/{key}:\r\n    get:\r\n      summary: Download video from Object Storage\r\n      parameters:\r\n        - name: key\r\n          in: path\r\n          required: true\r\n          schema:\r\n            type: string\r\n      x-yc-apigateway-integration:\r\n        type: object_storage\r\n        bucket: vvot10-tg-video\r\n        object: '{key}'\r\n        service_account_id: aje8krpkjdmjihbrrdo4\r\n      responses:\r\n        '200':\r\n          description: Video file",
            "status": "active",
            "timeouts": null,
            "user_domains": [],
            "variables": null
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.archive_file.receiver_zip",
            "data.template_file.openapi_spec",
            "yandex_function.func_receiver",
            "yandex_message_queue.queue_downloader",
            "yandex_message_queue.queue_receiver",
            "yandex_storage_bucket.bucket"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_function",
      "name": "func_downloader",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "async_invocation": [],
            "concurrency": 1,
            "connectivity": [],
            "content": [
              {
                "zip_filename": "./build/downloader.zip"
              }
            ],
            "created_at": "2025-12-21T17:39:53Z",
            "description": "Downloads video from Telegram and stores it",
            "entrypoint": "index.handler",
            "environment": {
              "BUCKET": "vvot10-tg-video",
              "TG_TOKEN": "8400533416:AAECeAyN78E3gIBATFe_NY7y-7aOGITuaN8"
            },
            "execution_timeout": "60",
            "folder_id": "b1gkt91feoc05m2bu972",
            "id": "d4e7oscni205l9tqbe1n",
            "image_size": 31469568,
            "labels": {},
            "log_options": [],
            "memory": 256,
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 0,
                "gce_http_endpoint": 0
              }
            ],
            "mounts": [],
            "name": "vvot10-func-downloader",
            "package": [],
            "runtime": "python311",
            "secrets": [],
            "service_account_id": "aje8krpkjdmjihbrrdo4",
            "storage_mounts": [],
            "tags": [],
            "timeouts": null,
            "tmpfs_size": 0,
            "user_hash": "PXa+xpobjxX+xW86/2UPqtkSNNXQilelUybHPRdY4zM=",
            "version": "d4e3csllm3uk5b55e99j"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "environment"
              },
              {
                "type": "index",
                "value": {
                  "value": "TG_TOKEN",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.archive_file.downloader_zip",
            "data.archive_file.receiver_zip",
            "data.template_file.openapi_spec",
            "yandex_api_gateway.api",
            "yandex_function.func_receiver",
            "yandex_message_queue.queue_downloader",
            "yandex_message_queue.queue_receiver",
            "yandex_storage_bucket.bucket"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_function",
      "name": "func_receiver",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "async_invocation": [],
            "concurrency": 1,
            "connectivity": [],
            "content": [
              {
                "zip_filename": "./build/receiver.zip"
              }
            ],
            "created_at": "2025-12-21T17:39:52Z",
            "description": "Handles incoming Telegram updates",
            "entrypoint": "index.handler",
            "environment": {
              "DOWNLOADER_QUEUE_URL": "https://message-queue.api.cloud.yandex.net/b1gkt91feoc05m2bu972/vvot10-queue-downloader",
              "TG_TOKEN": "8400533416:AAECeAyN78E3gIBATFe_NY7y-7aOGITuaN8"
            },
            "execution_timeout": "10",
            "folder_id": "b1gkt91feoc05m2bu972",
            "id": "d4e3f81idssgfs5papic",
            "image_size": 31465472,
            "labels": {},
            "log_options": [],
            "memory": 128,
            "metadata_options": [
              {
                "aws_v1_http_endpoint": 0,
                "gce_http_endpoint": 0
              }
            ],
            "mounts": [],
            "name": "vvot10-func-receiver",
            "package": [],
            "runtime": "python311",
            "secrets": [],
            "service_account_id": "aje8krpkjdmjihbrrdo4",
            "storage_mounts": [],
            "tags": [],
            "timeouts": null,
            "tmpfs_size": 0,
            "user_hash": "NBM9Hf6jpIKVZJ/d3UEXlif7Mmw9PS2KRMr94zQkVC8=",
            "version": "d4eahb46j4gqbti4ngrr"
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "environment"
              },
              {
                "type": "index",
                "value": {
                  "value": "TG_TOKEN",
                  "type": "string"
                }
              }
            ]
          ],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjo2MDAwMDAwMDAwMDAsImRlbGV0ZSI6NjAwMDAwMDAwMDAwLCJ1cGRhdGUiOjYwMDAwMDAwMDAwMH0sInNjaGVtYV92ZXJzaW9uIjoiMSJ9",
          "dependencies": [
            "data.archive_file.receiver_zip",
            "yandex_message_queue.queue_downloader"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_function_trigger",
      "name": "trigger_downloader",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "container": [],
            "container_registry": [],
            "created_at": "2025-12-21T17:40:06Z",
            "data_streams": [],
            "description": "",
            "dlq": [],
            "folder_id": "b1gkt91feoc05m2bu972",
            "function": [
              {
                "id": "d4e7oscni205l9tqbe1n",
                "retry_attempts": "",
                "retry_interval": "",
                "service_account_id": "aje8krpkjdmjihbrrdo4",
                "tag": ""
              }
            ],
            "id": "a1sdgkqt4r5k8o3744sv",
            "iot": [],
            "labels": {},
            "log_group": [],
            "logging": [],
            "mail": [],
            "message_queue": [
              {
                "batch_cutoff": "10",
                "batch_size": "1",
                "queue_id": "yrn:yc:ymq:ru-central1:b1gkt91feoc05m2bu972:vvot10-queue-downloader",
                "service_account_id": "aje8krpkjdmjihbrrdo4",
                "visibility_timeout": ""
              }
            ],
            "name": "vvot10-trigger-downloader",
            "object_storage": [],
            "timeouts": null,
            "timer": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.archive_file.downloader_zip",
            "data.archive_file.receiver_zip",
            "data.template_file.openapi_spec",
            "yandex_api_gateway.api",
            "yandex_function.func_downloader",
            "yandex_function.func_receiver",
            "yandex_message_queue.queue_downloader",
            "yandex_message_queue.queue_receiver",
            "yandex_storage_bucket.bucket"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_function_trigger",
      "name": "trigger_receiver",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "container": [],
            "container_registry": [],
            "created_at": "2025-12-21T17:40:05Z",
            "data_streams": [],
            "description": "",
            "dlq": [],
            "folder_id": "b1gkt91feoc05m2bu972",
            "function": [
              {
                "id": "d4e3f81idssgfs5papic",
                "retry_attempts": "",
                "retry_interval": "",
                "service_account_id": "aje8krpkjdmjihbrrdo4",
                "tag": ""
              }
            ],
            "id": "a1sidhde2eletdt7p11q",
            "iot": [],
            "labels": {},
            "log_group": [],
            "logging": [],
            "mail": [],
            "message_queue": [
              {
                "batch_cutoff": "10",
                "batch_size": "1",
                "queue_id": "yrn:yc:ymq:ru-central1:b1gkt91feoc05m2bu972:vvot10-queue-receiver",
                "service_account_id": "aje8krpkjdmjihbrrdo4",
                "visibility_timeout": ""
              }
            ],
            "name": "vvot10-trigger-receiver",
            "object_storage": [],
            "timeouts": null,
            "timer": []
          },
          "sensitive_attributes": [],
          "identity_schema_version": 0,
          "private": "eyJlMmJmYjczMC1lY2FhLTExZTYtOGY4OC0zNDM2M2JjN2M0YzAiOnsiY3JlYXRlIjozMDAwMDAwMDAwMDAsImRlbGV0ZSI6MzAwMDAwMDAwMDAwLCJ1cGRhdGUiOjMwMDAwMDAwMDAwMH19",
          "dependencies": [
            "data.archive_file.receiver_zip",
            "yandex_function.func_receiver",
            "yandex_message_queue.queue_downloader",
            "yandex_message_queue.queue_receiver"
          ]
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_message_queue",
      "name": "queue_downloader",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 0,
          "attributes": {
            "access_key": "",
            "arn": "yrn:yc:ymq:ru-central1:b1gkt91feoc05m2bu972:vvot10-queue-downloader",
            "content_based_deduplication": false,
            "delay_seconds": 0,
            "fifo_queue": false,
            "id": "https://message-queue.api.cloud.yandex.net/b1g71e95h51okii30p25/dj60000000a9hdep02mk/vvot10-queue-downloader",
            "max_message_size": 262144,
            "message_retention_seconds": 345600,
            "name": "vvot10-queue-downloader",
            "name_prefix": null,
            "receive_wait_time_seconds": 0,
            "redrive_policy": "",
            "region_id": "ru-central1",
            "secret_key": "",
            "tags": {},
            "visibility_timeout_seconds": 30
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_key"
              }
            ]
          ],
          "identity_schema_version": 0,
          "private": "bnVsbA=="
        }
      ]
    },
    {
      "mode": "managed",
      "type": "yandex_storage_bucket",
      "name": "bucket",
      "provider": "provider[\"registry.terraform.io/yandex-cloud/yandex\"]",
      "instances": [
        {
          "schema_version": 1,
          "attributes": {
            "access_key": "",
            "acl": null,
            "anonymous_access_flags": [
              {
                "config_read": false,
                "list": false,
                "read": false
              }
            ],
            "bucket": "vvot10-tg-video",
            "bucket_domain_name": "vvot10-tg-video.storage.yandexcloud.net",
            "bucket_prefix": null,
            "cors_rule": [],
            "default_storage_class": "STANDARD",
            "folder_id": "b1gkt91feoc05m2bu972",
            "force_destroy": false,
            "grant": [],
            "https": [],
            "id": "vvot10-tg-video",
            "lifecycle_rule": [],
            "logging": [],
            "max_size": 0,
            "object_lock_configuration": [],
            "policy": "",
            "secret_key": "",
            "server_side_encryption_configuration": [],
            "tags": {},
            "versioning": [
              {
                "enabled": false
              }
            ],
            "website": [],
            "website_domain": null,
            "website_endpoint": null
          },
          "sensitive_attributes": [
            [
              {
                "type": "get_attr",
                "value": "secret_key"
              }
            ]
          ],
          "identity_schema_version": 0,
          "private": "eyJzY2hlbWFfdmVyc2lvbiI6IjEifQ=="
        }
      ]
    }
  ],
  "check_results": null
}
